Данный алгоритм сортировки может выхывать проблемы - ошибки выхода за диапазон массива.
Попытка написать новый алгоритм - в папке homework 4-3-2 - improved - по методу, предложенному Михаилом Смирновым